This is the third version of the code that is actually a library. 