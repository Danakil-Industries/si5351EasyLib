This is the second version of the code that is actually a library. 
	The purpose of this version is to try and track down anything taking a long time and try to re-write it so that it takes less time.